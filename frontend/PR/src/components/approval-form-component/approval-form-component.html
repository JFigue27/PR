<div class="box-pr-form approval-comments">
  <div class="header primary-color">
    <p>Approval</p>
  </div>
  <div class="body">

    <mat-form-field class="input" >
      <input matInput placeholder="User Request" [(ngModel)]="baseEntity.RequestDescription" [readonly]=" getCurrentRole() != 'User' ">
    </mat-form-field>
    <br>   
    <mat-form-field class="input">
      <input matInput placeholder="Manager Response" [(ngModel)]="baseEntity.ResponseDescription" 
      [readonly]="getCurrentRole() === 'User' || getCurrentRole() === 'MRO'">
    </mat-form-field>

  </div>

</div>


<div class="div-buttons">  

  <div *ngIf="getCurrentRole() == 'User' && (!baseEntity.Status || baseEntity.Status == 'Pending' || baseEntity.Status == 'Rejected') ">
    <button mat-raised-button color="basic" (click)="requestApproval('Pending')">Request to Manager</button>
    <!-- <button mat-raised-button color="basic" (click)="requestApproval('MRO Quote')">Request to MRO</button> -->
  </div>

  <div *ngIf="getCurrentRole() == 'MRO'">
    <button mat-raised-button color="basic" (click)="answerApproval('MRO Quoted')">Send to Purchasing Manager</button>
    <button mat-raised-button color="basic" (click)="requestApproval('Finalized')"
    *ngIf="baseEntity.Status == 'DM Quote Approved' || baseEntity.Status == 'GM Quote Approved' ">Finalize</button>
  </div>

  <div *ngIf="getCurrentRole() == 'Department Manager'">

    <button mat-raised-button color="basic" (click)="requestApproval('Pending')"
    *ngIf="!baseEntity.Status || baseEntity.Status == 'Pending' ">Request to Manager</button>
    <button  mat-raised-button color="basic" (click)="answerApproval('DM Quote')"
    *ngIf=" !baseEntity.Status || baseEntity.Status == 'Pending' || baseEntity.Status == 'DM Rejected' ">Send to MRO</button>
    
    <button mat-raised-button color="warn" (click)="answerApproval('DM Rejected')"
    *ngIf="pr.InfoTrack?.User_CreatedByKey != getCurrentUser().UserKey  && ( baseEntity.Status == 'Pending' || baseEntity.Status == 'MRO Quote' || baseEntity.Status == 'DM Quote') ">Reject</button>
    
    <button *ngIf="baseEntity.Status == 'DM Quote Rejected' " mat-raised-button color="basic" (click)="answerApproval('DM Quote Approved')">Approve quote</button>
    <button *ngIf="baseEntity.Status == 'DM Quote Approved' " mat-raised-button color="warn" (click)="answerApproval('DM Quote Rejected')">Reject quote</button>
  </div>

  <div *ngIf="getCurrentRole() == 'General Manager'">
    <button mat-raised-button color="basic" (click)="answerApproval('GM Approved')">Approve quote</button>
    <button mat-raised-button color="warn" (click)="answerApproval('GM Rejected')">Reject quote</button>  
  </div>
        
  <div *ngIf="getCurrentRole() == 'Purchasing Manager'">
    <button mat-raised-button color="warn" (click)="requestApproval('PM Rejected')"
     *ngIf="baseEntity.Status == 'MRO Quoted' || baseEntity.Status == 'PM Approved' ">Reject Quote</button>
    <button mat-raised-button color="basic" (click)="requestApproval('PM Approved')"
     *ngIf="baseEntity.Status == 'MRO Quoted' || baseEntity.Status == 'PM Rejected'">Approve Quote</button>
  </div>

</div>

<!-- <pre> USUARIO: {{getCurrentUser().UserKey | json}}</pre> -->
<!-- <pre>{{ baseEntity | json }}</pre> -->

